<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

<ui:composition template="/templates/layout.xhtml">
    <ui:define name="title">Recuperar Contraseña</ui:define>
    
    <ui:define name="content">
        <section class="py-5">
            <div class="container" style="max-width: 600px;">
                <h2 class="text-center text-primary mb-4">Recuperar Contraseña</h2>
                <p class="text-center text-muted mb-4">
                    Ingresa tu correo electrónico y te enviaremos un código para recuperar tu contraseña.
                </p>
                
                <p:panel styleClass="shadow-sm">
                    <div class="p-4">
                        <h:form>
                            <p:messages id="messages"/>
                            
                            <div class="mb-3">
                                <label class="form-label">
                                    <i class="fas fa-envelope me-2"></i>Correo electrónico
                                </label>
                                <p:inputText value="#{forgotPasswordBean.email}" 
                                           styleClass="form-control" 
                                           placeholder="tu@email.com"
                                           disabled="#{forgotPasswordBean.tokenGenerated}"
                                           required="true"/>
                            </div>
                            
                            <p:commandButton value="Enviar Código" 
                                           styleClass="btn btn-primary w-100 mb-3"
                                           action="#{forgotPasswordBean.enviarCodigo}"
                                           update="@form"
                                           rendered="#{!forgotPasswordBean.tokenGenerated}"/>
                            
                            <p:panel rendered="#{forgotPasswordBean.tokenGenerated}" 
                                   styleClass="alert alert-success">
                                <p class="mb-2">
                                    <i class="fas fa-check-circle me-2"></i>
                                    Se ha generado un código de recuperación. Revisa tu email.
                                </p>
                                <div class="mt-3 p-3 bg-white rounded">
                                    <strong>Código de recuperación:</strong>
                                    <div class="mt-2 p-2 bg-light rounded" style="font-family: monospace; font-size: 12px; word-break: break-all;">
                                        #{forgotPasswordBean.token}
                                    </div>
                                    <small class="text-muted d-block mt-2">
                                        Copia este código y úsalo en la siguiente página.
                                    </small>
                                </div>
                            </p:panel>
                            
                            <p:commandButton value="Continuar al Reset de Contraseña" 
                                           styleClass="btn btn-primary w-100"
                                           action="#{forgotPasswordBean.continuar}"
                                           rendered="#{forgotPasswordBean.tokenGenerated}"/>
                            
                            <div class="text-center mt-3">
                                <p class="mb-0">
                                    ¿Recordaste tu contraseña? 
                                    <h:link outcome="home" value="Iniciar Sesión" styleClass="text-primary"/>
                                </p>
                            </div>
                        </h:form>
                    </div>
                </p:panel>
            </div>
        </section>
    </ui:define>
</ui:composition>
</html>
