<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <body>
        <ui:composition template="./../../TemplateSitio.xhtml">
            <ui:define name="content">
                
                <h:form id="formEmocional">
                    <p:growl id="msgs" showDetail="true"/>

                    <div class="container mt-4 mb-5">
                        
                        <div class="d-flex justify-content-between align-items-center mb-4 p-3 bg-white rounded shadow-sm border-start border-5 border-info">
                            <div>
                                <h4 class="fw-bold text-primary mb-0">
                                    <i class="fas fa-brain me-2"></i>Bienestar Emocional y Competencias Socioemocionales
                                </h4>
                                <small class="text-muted">Valoración de habilidades intrapersonales e interpersonales.</small>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-light text-dark border">Estudiante: #{caracterizacionControllerMejorado.estudiante.primerNombreEstudiante}</span>
                            </div>
                        </div>

                        <div class="row">
                            
                            <div class="col-lg-8">
                                
                                <div class="card shadow-sm border-0 mb-4">
                                    <div class="card-header bg-info text-white fw-bold">
                                        <i class="fas fa-user me-2"></i>1. Relación Consigo Mismo (Intrapersonal)
                                    </div>
                                    <div class="card-body">
                                        <p class="small text-muted mb-3">Evalúe la frecuencia de las siguientes conductas observadas o reportadas.</p>
                                        
                                        <div class="table-responsive">
                                            <table class="table table-hover align-middle">
                                                <thead class="table-light small">
                                                    <tr>
                                                        <th style="width: 40%">Indicador</th>
                                                        <th class="text-center">Nunca (1)</th>
                                                        <th class="text-center">A veces (2)</th>
                                                        <th class="text-center">Casi Siempre (3)</th>
                                                        <th class="text-center">Siempre (4)</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>Autoconciencia:</strong> Identifica y nombra sus emociones.</td>
                                                        <td colspan="4">
                                                            <p:selectOneRadio value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.identificaEmociones}" unselectable="true">
                                                                <f:selectItem itemLabel="" itemValue="1" />
                                                                <f:selectItem itemLabel="" itemValue="2" />
                                                                <f:selectItem itemLabel="" itemValue="3" />
                                                                <f:selectItem itemLabel="" itemValue="4" />
                                                            </p:selectOneRadio>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Expresión:</strong> Expresa lo que siente de forma adecuada (sin agredir).</td>
                                                        <td colspan="4">
                                                            <p:selectOneRadio value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.expresaEmociones}">
                                                                <f:selectItem itemLabel="" itemValue="1" />
                                                                <f:selectItem itemLabel="" itemValue="2" />
                                                                <f:selectItem itemLabel="" itemValue="3" />
                                                                <f:selectItem itemLabel="" itemValue="4" />
                                                            </p:selectOneRadio>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Regulación:</strong> Logra calmarse ante situaciones de ira o frustración.</td>
                                                        <td colspan="4">
                                                            <p:selectOneRadio value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.regulaImpulsos}">
                                                                <f:selectItem itemLabel="" itemValue="1" />
                                                                <f:selectItem itemLabel="" itemValue="2" />
                                                                <f:selectItem itemLabel="" itemValue="3" />
                                                                <f:selectItem itemLabel="" itemValue="4" />
                                                            </p:selectOneRadio>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Autoestima:</strong> Se expresa positivamente sobre sí mismo/a.</td>
                                                        <td colspan="4">
                                                            <p:selectOneRadio value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.autoestima}">
                                                                <f:selectItem itemLabel="" itemValue="1" />
                                                                <f:selectItem itemLabel="" itemValue="2" />
                                                                <f:selectItem itemLabel="" itemValue="3" />
                                                                <f:selectItem itemLabel="" itemValue="4" />
                                                            </p:selectOneRadio>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <div class="card shadow-sm border-0 mb-4">
                                    <div class="card-header bg-success text-white fw-bold">
                                        <i class="fas fa-users me-2"></i>2. Relación con los Demás (Interpersonal)
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover align-middle">
                                                <thead class="table-light small">
                                                    <tr>
                                                        <th style="width: 40%">Indicador</th>
                                                        <th class="text-center">Escala de Frecuencia (1-4)</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><strong>Empatía:</strong> Reconoce y comprende los sentimientos de otros.</td>
                                                        <td>
                                                            <p:rating value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.empatia}" stars="4" cancel="false"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Escucha Activa:</strong> Presta atención respetuosa cuando otros hablan.</td>
                                                        <td>
                                                            <p:rating value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.escuchaActiva}" stars="4" cancel="false"/>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td><strong>Resolución de Conflictos:</strong> Busca acuerdos sin usar la violencia.</td>
                                                        <td>
                                                            <p:rating value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.resuelveConflictos}" stars="4" cancel="false"/>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card shadow-sm border-0">
                                    <div class="card-body">
                                        <label class="form-label fw-bold">Análisis Cualitativo del Profesional</label>
                                        <p:inputTextarea value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.observacionesPsico}" 
                                                         rows="4" styleClass="form-control" 
                                                         placeholder="Describa fortalezas emocionales y situaciones detonantes observadas..."/>
                                    </div>
                                </div>

                            </div>

                            <div class="col-lg-4">
                                <div class="card shadow border-0 border-top border-3 border-danger">
                                    <div class="card-header bg-white">
                                        <h6 class="text-danger fw-bold mb-0"><i class="fas fa-exclamation-triangle me-2"></i>Signos de Alarma</h6>
                                    </div>
                                    <div class="card-body bg-light">
                                        <p class="small text-muted">Seleccione si ha observado alguno de estos signos de riesgo psicosocial:</p>
                                        
                                        <p:selectManyCheckbox value="#{caracterizacionControllerMejorado.bienestarEmocionalActual.signosAlarma}" 
                                                              layout="pageDirection" styleClass="w-100 checkbox-danger">
                                            <f:selectItem itemLabel="Cambios bruscos de humor" itemValue="Cambios Humor" />
                                            <f:selectItem itemLabel="Aislamiento social repentino" itemValue="Aislamiento" />
                                            <f:selectItem itemLabel="Llanto frecuente sin causa aparente" itemValue="Llanto" />
                                            <f:selectItem itemLabel="Conductas agresivas (físicas/verbales)" itemValue="Agresividad" />
                                            <f:selectItem itemLabel="Expresión de desesperanza" itemValue="Desesperanza" />
                                            <f:selectItem itemLabel="Autolesiones o conductas de riesgo" itemValue="Autolesiones" />
                                            <f:selectItem itemLabel="Alteraciones de sueño/alimentación" itemValue="Sueño/Alimentación" />
                                        </p:selectManyCheckbox>
                                        
                                        <div class="alert alert-warning mt-3 small">
                                            <i class="fas fa-info-circle"></i> <strong>Nota:</strong> Si selecciona signos graves (como autolesiones), el sistema sugerirá activar la Ruta de Atención Integral.
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="d-grid gap-2 mt-4">
                                    <p:commandButton value="Guardar Dimensión" 
                                                     action="#{caracterizacionControllerMejorado.guardarDimensionEmocional}" 
                                                     styleClass="btn btn-primary btn-lg shadow-sm"
                                                     icon="fas fa-save" update="@form"/>
                                                     
                                    <h:button value="Cancelar" outcome="dashboard_dimensiones" styleClass="btn btn-outline-secondary"/>
                                </div>
                            </div>

                        </div>
                    </div>
                </h:form>
                
                <style>
                    /* Ajuste para centrar radio buttons en la tabla */
                    .ui-selectoneradio { display: flex; justify-content: space-around; width: 100%; }
                    .ui-selectoneradio label { display: none; } /* Ocultar labels repetitivos en tabla */
                    .checkbox-danger .ui-chkbox-box.ui-state-active {
                        border-color: #dc3545; background: #dc3545;
                    }
                </style>

            </ui:define>
        </ui:composition>
    </body>
</html>